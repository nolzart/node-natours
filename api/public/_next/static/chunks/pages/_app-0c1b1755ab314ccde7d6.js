_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[8],{0:function(e,t,n){n("GcxT"),e.exports=n("nOHt")},"1TCz":function(e,t,n){"use strict";n.r(t);var r=n("o0o1"),a=n.n(r),c=n("HaE+"),o=n("rePB"),s=n("nKUr"),u=n("q1tI"),i=n("/MKj");function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==l(t)&&"function"!==typeof t?h(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var y=function(e){function t(){var e,n;p(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return v(h(n=d(this,(e=b(t)).call.apply(e,[this].concat(a)))),"state",{bootstrapped:!1}),v(h(n),"_unsubscribe",void 0),v(h(n),"handlePersistorState",(function(){n.props.persistor.getState().bootstrapped&&(n.props.onBeforeLift?Promise.resolve(n.props.onBeforeLift()).finally((function(){return n.setState({bootstrapped:!0})})):n.setState({bootstrapped:!0}),n._unsubscribe&&n._unsubscribe())})),n}var n,r,a;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,e),n=t,(r=[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return"function"===typeof this.props.children?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}])&&f(n.prototype,r),a&&f(n,a),t}(u.PureComponent);v(y,"defaultProps",{children:null,loading:null});var O=n("YFqc"),m=n.n(O),g=n("Aiso"),x=n.n(g),w=n("yclj"),_=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.auth})),n=t.user,r=t.isAuthenticated;return Object(s.jsxs)("header",{className:"header",children:[Object(s.jsx)("input",{type:"checkbox",name:"nav__checkbox",id:"nav__checkbox",className:"nav__checkbox"}),Object(s.jsx)("nav",{className:"nav nav--tours",children:Object(s.jsx)(m.a,{href:"/",children:Object(s.jsx)("a",{className:"nav__el",children:"All tours"})})}),Object(s.jsx)("label",{htmlFor:"nav__checkbox",children:Object(s.jsx)("div",{className:"header__logo",children:Object(s.jsx)(x.a,{src:"/img/logo-white.png",alt:"Natours logo",height:100,width:195,priority:!0})})}),Object(s.jsx)("nav",{className:"nav nav--user",children:r?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("button",{type:"button",className:"nav__el nav__el--logout",onClick:function(){return e(Object(w.b)())},children:"Log out"}),Object(s.jsx)(m.a,{href:"/me",children:Object(s.jsxs)("a",{className:"nav__el",children:[Object(s.jsx)("img",{src:"/img/users/".concat(n.photo),alt:"".concat(n.name),className:"nav__user-img"}),Object(s.jsx)("span",{children:n.name.split(" ")[0]})]})})]}):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(m.a,{href:"/login",children:Object(s.jsx)("a",{className:"nav__el",children:"Login"})}),Object(s.jsx)(m.a,{href:"/signup",children:Object(s.jsx)("a",{className:"nav__el nav__el--cta",children:"Sign up"})})]})})]})},k=function(){return Object(s.jsxs)("footer",{className:"footer",children:[Object(s.jsx)("div",{className:"footer__logo",children:Object(s.jsx)(x.a,{src:"/img/logo-green.png",alt:"Natours logo",height:60,width:300,priority:!0})}),Object(s.jsxs)("ul",{className:"footer__nav",children:[Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"#",children:"About Us"})}),Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"#",children:"Download Apps"})}),Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"#",children:"Become a guides"})}),Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"#",children:"Careers"})}),Object(s.jsx)("li",{children:Object(s.jsx)("a",{href:"#",children:"Contact"})})]}),Object(s.jsx)("p",{className:"footer__copyright",children:"\xa9 by Jonas Schmedtmann. Fell free to use this Project for your own purposes, EXCEPT producing your own course or tutorial."})]})},E=function(e){var t=e.children;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(_,{}),t,Object(s.jsx)(k,{})]})},P=function(){var e=Object(u.useState)(!0),t=e[0],n=e[1],r=Object(i.c)((function(e){return e.alert})),a=r.status,c=r.message,o=Object(i.b)();return Object(u.useEffect)((function(){o({type:"UPDATE_ALERT",payload:{status:a,message:c}}),n(!0);var e=setTimeout((function(){n(!1),o({type:"RESET_ALERT"})}),5e3);return function(){return clearTimeout(e)}}),[c,a]),t&&Object(s.jsx)("div",{className:"alert alert--".concat(a),children:c})},T=n("rKdZ"),N=n("vDqi"),S=n.n(N),M=function(e){return e?S.a.defaults.headers.common.Authorization="Bearer ".concat(e):delete S.a.defaults.headers.common.Authorization},C=n("QqKt");n("WMMs");function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A=function(e){var t=e.Component,n=e.pageProps,r=Object(i.d)(),a=Object(i.c)((function(e){return e.auth})),c=a.loading,o=a.token;return Object(u.useEffect)((function(){return r.dispatch(Object(w.c)())}),[]),Object(u.useEffect)((function(){return M(o)}),[o]),Object(s.jsx)(y,{persistor:r.__persistor,loading:null,children:c?Object(s.jsx)(T.a,{}):Object(s.jsxs)(E,{children:[Object(s.jsx)(P,{}),Object(s.jsx)(t,R({},n))]})})};A.getInitialProps=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.Component,r=t.ctx,!n.getInitialProps){e.next=7;break}return e.next=4,n.getInitialProps(r);case 4:e.t0=e.sent,e.next=8;break;case 7:e.t0={};case 8:return c=e.t0,e.abrupt("return",{pageProps:c});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.default=C.a.withRedux(A)},GcxT:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n("1TCz")}])},WMMs:function(e,t,n){},YFqc:function(e,t,n){e.exports=n("cTJO")},cTJO:function(e,t,n){"use strict";var r=n("J4zp"),a=n("284h");t.__esModule=!0,t.default=void 0;var c=a(n("q1tI")),o=n("elyg"),s=n("nOHt"),u=n("vNVm"),i={};function l(e,t,n,r){if((0,o.isLocalURL)(t)){e.prefetch(t,n,r).catch((function(e){0}));var a=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;i[t+"%"+n+(a?"%"+a:"")]=!0}}var p=function(e){var t=!1!==e.prefetch,n=(0,s.useRouter)(),a=n&&n.pathname||"/",p=c.default.useMemo((function(){var t=(0,o.resolveHref)(a,e.href,!0),n=r(t,2),c=n[0],s=n[1];return{href:c,as:e.as?(0,o.resolveHref)(a,e.as):s||c}}),[a,e.href,e.as]),f=p.href,d=p.as,b=e.children,h=e.replace,j=e.shallow,v=e.scroll,y=e.locale;"string"===typeof b&&(b=c.default.createElement("a",null,b));var O=c.Children.only(b),m=O&&"object"===typeof O&&O.ref,g=(0,u.useIntersection)({rootMargin:"200px"}),x=r(g,2),w=x[0],_=x[1],k=c.default.useCallback((function(e){w(e),m&&("function"===typeof m?m(e):"object"===typeof m&&(m.current=e))}),[m,w]);(0,c.useEffect)((function(){var e=_&&t&&(0,o.isLocalURL)(f),r="undefined"!==typeof y?y:n&&n.locale,a=i[f+"%"+d+(r?"%"+r:"")];e&&!a&&l(n,f,d,{locale:r})}),[d,f,_,y,t,n]);var E={ref:k,onClick:function(e){O.props&&"function"===typeof O.props.onClick&&O.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,c,s,u){("A"!==e.currentTarget.nodeName||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&(0,o.isLocalURL)(n))&&(e.preventDefault(),null==s&&(s=r.indexOf("#")<0),t[a?"replace":"push"](n,r,{shallow:c,locale:u}).then((function(e){e&&s&&(window.scrollTo(0,0),document.body.focus())})))}(e,n,f,d,h,j,v,y)},onMouseEnter:function(e){(0,o.isLocalURL)(f)&&(O.props&&"function"===typeof O.props.onMouseEnter&&O.props.onMouseEnter(e),l(n,f,d,{priority:!0}))}};return(e.passHref||"a"===O.type&&!("href"in O.props))&&(E.href=(0,o.addBasePath)((0,o.addLocale)(d,"undefined"!==typeof y?y:n&&n.locale,n&&n.defaultLocale))),c.default.cloneElement(O,E)};t.default=p},vNVm:function(e,t,n){"use strict";var r=n("J4zp"),a=n("TqRt");t.__esModule=!0,t.useIntersection=function(e){var t=e.rootMargin,n=e.disabled||!s,a=(0,c.useRef)(),i=(0,c.useState)(!1),l=r(i,2),p=l[0],f=l[1],d=(0,c.useCallback)((function(e){a.current&&(a.current(),a.current=void 0),n||p||e&&e.tagName&&(a.current=function(e,t,n){var r=function(e){var t=e.rootMargin||"",n=u.get(t);if(n)return n;var r=new Map,a=new IntersectionObserver((function(e){e.forEach((function(e){var t=r.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return u.set(t,n={id:t,observer:a,elements:r}),n}(n),a=r.id,c=r.observer,o=r.elements;return o.set(e,t),c.observe(e),function(){c.unobserve(e),0===o.size&&(c.disconnect(),u.delete(a))}}(e,(function(e){return e&&f(e)}),{rootMargin:t}))}),[n,t,p]);return(0,c.useEffect)((function(){s||p||(0,o.default)((function(){return f(!0)}))}),[p]),[d,p]};var c=n("q1tI"),o=a(n("0G5g")),s="undefined"!==typeof IntersectionObserver;var u=new Map},wx8e:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r="GET_ALL_TOURS",a="GET_TOUR",c="GET_MY_TOURS"},yclj:function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return j}));var r=n("o0o1"),a=n.n(r),c=n("HaE+"),o=n("vDqi"),s=n.n(o),u=n("MlCo"),i=n("S3Lv"),l=n("hyzv"),p=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(l.a)(Object(c.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.patch("/api/v1/users/updateMe",e);case 2:r=t.sent,n({type:u.f,payload:r.data.data}),n({type:i.a,payload:{status:"success",message:"Data updated successfully!"}});case 5:case"end":return t.stop()}}),t)}))),n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},f=function(e){return function(){var t=Object(c.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(l.a)(Object(c.a)(a.a.mark((function t(){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.a.patch("/api/v1/users/updateMyPassword",e);case 2:r=t.sent,n({type:u.g,payload:r.data}),n({type:i.a,payload:{status:"success",message:"Password updated successfully!"}});case 5:case"end":return t.stop()}}),t)}))),n));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},d=function(e){var t=e.name,n=e.email,r=e.password,o=e.passwordConfirm;return function(){var e=Object(c.a)(a.a.mark((function e(c){var l,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.a.post("/api/v1/users/signup",{name:t,email:n,password:r,passwordConfirm:o});case 3:l=e.sent,c({type:i.a,payload:{status:"success",message:"Successfully registered!"}}),c({type:u.e,payload:l.data}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),p=e.t0.response?e.t0.response.data.message:"Something went wrong!",c({type:i.a,payload:{status:"error",message:p}});case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()},b=function(e){var t=e.email,n=e.password;return function(){var e=Object(c.a)(a.a.mark((function e(r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l.a)(Object(c.a)(a.a.mark((function e(){var c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/api/v1/users/login",{email:t,password:n},{headers:{withCredentials:!0}});case 2:c=e.sent,r({type:i.a,payload:{status:"success",message:"Logged in successfully!"}}),r({type:u.b,payload:c.data});case 5:case"end":return e.stop()}}),e)}))),r));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},h=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(l.a)(Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/api/v1/users/logout");case 2:t({type:u.c});case 3:case"end":return e.stop()}}),e)}))),t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},j=function(){return function(){var e=Object(c.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:u.a}),e.next=4,s.a.get("/api/v1/users/refreshToken");case 4:n=e.sent,t({type:u.d,payload:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t({type:u.d,payload:{token:"",data:{user:{}}}});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}}},[[0,1,2,0,3,6]]]);